---
title: Stocks Portfolio Analysis
author: Aaron Simumba
date: "2017-03-17"
slug: portfolio-analysis
tags: 
  - GOOG
  - AMAZON
  - APPLE
  - Stocks
output: 
  html_document: 
    keep_md: yes
description: Stock portfolio - a quick overview
image: "images/background.jpg"
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/dygraphs/dygraph.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dygraphs/dygraph-combined.js"></script>
<script src="/rmarkdown-libs/moment/moment.js"></script>
<script src="/rmarkdown-libs/moment-timezone/moment-timezone-with-data.js"></script>
<script src="/rmarkdown-libs/moment-fquarter/moment-fquarter.min.js"></script>
<script src="/rmarkdown-libs/dygraphs-binding/dygraphs.js"></script>


<pre class="r"><code>## Packages to load
library(quantmod)
library(ggplot2) 
library(xts)
library(highcharter)
library(PerformanceAnalytics)
library(dygraphs)</code></pre>
<pre class="r"><code>## Dates have been loaded as a factor instead of as dates. There is need to convert this variable to the date class and covert the rest of the variables to xts(Extensible Time Series)

temp &lt;- xts(x =fundreturn[,-1], order.by = as.Date(fundreturn[,1])) 
# all the variables except data are coerced to xts using date as the index.
# Overwriting the fundreturn object with the xts temp object
fundreturn &lt;- temp
str(fundreturn)</code></pre>
<pre><code>## An &#39;xts&#39; object on 2007-06-01/2016-11-01 containing:
##   Data: num [1:114, 1:18] 0.024 0.0057 0.0165 0.0126 -0.0301 0.0026 0.0045 0.0218 0.027 0.0315 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:18] &quot;SPY&quot; &quot;IJS&quot; &quot;VTI&quot; &quot;IYR&quot; ...
##   Indexed by objects of class: [Date] TZ: UTC
##   xts Attributes:  
##  NULL</code></pre>
<pre class="r"><code>rm(temp) # gettting rid of temp object
## Next I, stack variables of the same unique class within the same column. That is the returns of all the stocks in one column and the tickers in another column, indexed by the date variable.

# make use of a temporary object.
temp &lt;- data.frame(index(fundreturn), stack(as.data.frame(coredata(fundreturn))))
fundreturn_final &lt;- temp</code></pre>
<pre class="r"><code># Give the variables more descriptive names 
    names(fundreturn_final)[1] &lt;-  &quot;Year&quot;
    names(fundreturn_final)[2] &lt;-  &quot;PercentageReturn&quot;
    names(fundreturn_final)[3] &lt;-  &quot;Stockticker&quot;
    names(fundreturn_final)</code></pre>
<pre><code>## [1] &quot;Year&quot;             &quot;PercentageReturn&quot; &quot;Stockticker&quot;</code></pre>
<pre class="r"><code>  rm(temp) # removing the temp. object
  # we coerce the data frame back to xts to be able to use quantmod and highcharter
  
#fundreturn_final &lt;- xts(x=fundreturn_final[-1], order.by = as.Date(fundreturn_final[,1]))</code></pre>
<pre class="r"><code>ggplot(data = fundreturn_final, aes(x=Year, y=PercentageReturn, color=Stockticker)) +geom_line()</code></pre>
<p><img src="/post/2017-02-06-fund-returns_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># Google stock Performance
# GOOG
GOOG &lt;- subset(fundreturn_final, Stockticker==&quot;GOOG&quot;)
g &lt;- ggplot(data = GOOG, aes(x=Year, y=PercentageReturn)) +geom_line()
# add features
g &lt;- g + ggtitle(&quot;Google Monthly Return&quot;, subtitle = &quot;For the Period between June 2007 - Nov. 2016&quot;) + 
      theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;grey50&quot;),
            axis.text = element_text(colour = &quot;blue&quot;),
            axis.title.y = element_text(size = rel(1.0), angle = 90),
            axis.title.x = element_text(size = rel(1.0), angle = 360))

g &lt;- g + labs(x = &quot;Year&quot;,
        y =&quot;Return&quot;) 

g + annotate(&quot;text&quot;,x=as.Date(&quot;2009-09-01&quot;),y=0.3245,label=&quot;HR&quot;,fontface=&quot;bold&quot;,size=3, colour = &quot;forestgreen&quot;) +
annotate(&quot;text&quot;,x=as.Date(&quot;2010-04-01&quot;),y=-0.1900,label=&quot;LR&quot;,fontface=&quot;bold&quot;,size=3,colour =&quot;red&quot;) </code></pre>
<p><img src="/post/2017-02-06-fund-returns_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># Portfolio Performance Appraisal

# Having the following portfolio

# Google = GOOG, Amazon = AZMN,Apple = AAPL JP Morgans = JPM, Microsoft = MSFT, General Electric = GE, and Hewlett Packard = HPQ
#, &quot;GE&quot;, &quot;HPQ&quot;

p1 &lt;- subset(fundreturn_final, Stockticker ==&quot;AMZN&quot;)
p2 &lt;- subset(fundreturn_final, Stockticker ==&quot;MSFT&quot;)
p3 &lt;- subset(fundreturn_final, Stockticker ==&quot;AAPL&quot;)
p4 &lt;- subset(fundreturn_final, Stockticker ==&quot;GOOG&quot;)

portfolio &lt;- rbind(p1,p2,p3,p4) # binding the returns into one returns variable
rm(&quot;p1&quot;,&quot;p2&quot;, &quot;p3&quot;,&quot;p4&quot;) # Removal of the temp. subsets 
 
# quick visual representation of the data
p &lt;- ggplot(data = portfolio, aes(x = Year, y =PercentageReturn, colour = Stockticker))+geom_line()
p + labs(
        x = &quot; Year&quot;,
        y = &quot;Return&quot;,
        colour = &quot;Stock ticker&quot;) +
    ggtitle(&quot; Apple, Amazon and Google Stock Returns&quot;,subtitle =&quot; For the period June 2007 - Nov. 2016&quot;)</code></pre>
<p><img src="/post/2017-02-06-fund-returns_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>#Dygraphing

p1 &lt;- subset(fundreturn_final, Stockticker ==&quot;AMZN&quot;)
p2 &lt;- subset(fundreturn_final, Stockticker ==&quot;MSFT&quot;)
p3 &lt;- subset(fundreturn_final, Stockticker ==&quot;AAPL&quot;)
p4 &lt;- subset(fundreturn_final, Stockticker ==&quot;GOOG&quot;)


# Converting to xts before graphing
AMZN &lt;- xts(x = p1[,c(-1,-3)], order.by = p1[,1])
MSFT &lt;- xts(x = p2[,c(-1,-3)], order.by = p2[,1])
AAPL &lt;- xts(x = p3[,c(-1,-3)], order.by = p3[,1])
GOOG_ &lt;- xts(x = p4[,c(-1,-3)], order.by = p4[,1])

rm(&quot;p1&quot;,&quot;p2&quot;, &quot;p3&quot;,&quot;p4&quot;) # Removal of the temp. subsets </code></pre>
<pre class="r"><code>merged_returns &lt;- merge.xts(AMZN,MSFT,AAPL,GOOG_) # merging the separate share returns into one xts object.

dygraph(merged_returns, main = &quot;Amazon v Microsoft v Apple v Google&quot;) %&gt;% # Using pipes to connect the codes
  dyAxis(&quot;y&quot;, label =&quot;Return&quot;) %&gt;%
  dyAxis(&quot;x&quot;, label =&quot;Year&quot;) %&gt;%
  dyOptions(colors = RColorBrewer::brewer.pal(4, &quot;Set2&quot;)) </code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"attrs":{"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"title":"Amazon v Microsoft v Apple v Google","labels":["month","AMZN","MSFT","AAPL","GOOG_"],"legend":"auto","retainDateWindow":false,"ylabel":"Return","xlabel":"Year","stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colors":["#66C2A5","#FC8D62","#8DA0CB","#E78AC3"],"colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":true,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z"],[-0.0494,-0.1647,-0.0243,-0.0361,-0.017,0.1176,-0.3048,0.1465,0.0418,0.1859,0.0591,-0.0218,-0.0454,0.039,0.0166,0.5413,0.1273,-0.0106,0.1481,0.0174,0.1657,-0.0429,0.0158,0.023,-0.1613,-0.1703,0.1059,0.1028,0.038,-0.1016,0.041,0.0586,-0.0996,-0.2133,-0.254,0.2009,0.147,0.1015,0.1335,0.0964,-0.0314,0.0727,0.0251,-0.0533,0.1499,0.2726,0.1439,-0.0102,-0.0677,-0.0559,0.1467,0.0098,-0.0849,-0.1291,0.079,0.0589,0.2582,0.052,0.0616,0.0262,-0.0576,0.0215,0.0395,0.087,0.0045,0.0397,0.0882,-0.0328,0.0046,-0.0126,-0.0994,-0.0998,0.1233,-0.0759,0.127,0.1451,-0.0819,0.0725,0.0217,0.0642,0.0244,-0.0843,0.0823,-0.0047,0.0583,-0.0046,0.0084,-0.0476,0.0606,0.0315,0.0847,-0.0672,0.1127,0.1644,0.0813,0.0131,-0.1006,0.0095,-0.0711,-0.0958,0.0277,0.0391,-0.0363,0.0832,-0.049,-0.0527,0.1086,-0.0835,0.1424,0.0723,-0.0212,0.1335,0.0177,0.0113],[0.0765,-0.0422,0.0127,-0.1125,-0.0585,0.0287,0.0326,0.0721,0.0642,0.0497,0.0261,0.017,0.0335,-0.084,-0.0106,0.0743,0.0284,-0.0398,-0.0163,-0.0055,0.0254,0.2495,-0.0842,0.0595,-0.0843,-0.1624,0.0434,0.0049,-0.0034,-0.0286,-0.0651,0.0653,-0.022,-0.1634,-0.0884,-0.0386,-0.1204,-0.0491,0.1375,0.1029,0.0376,0.1379,-0.0105,0.0539,0.0434,0.0781,0.0653,0.0364,-0.0755,0.0221,0.0216,0.0427,-0.1514,-0.1081,0.1217,-0.0858,0.0435,0.089,-0.047,0.1049,-0.0064,-0.0358,-0.0448,0.0209,-0.0288,0.0396,0.0538,-0.0231,-0.0643,0.0699,-0.0322,0.0149,0.1375,0.0819,0.0164,-0.0074,-0.0824,0.048,-0.0366,0.0527,-0.0344,-0.041,-0.0596,0.0034,0.0277,0.0211,0.0291,0.1569,0.0618,-0.0103,-0.0782,0.0564,-0.0036,0.064,0.085,-0.0189,0.0115,0.02,0.07,-0.0144,0.0205,0.0186,0.035,0.0592,0.0205,0.0127,0.0247,-0.0284,-0.1302,0.0931,-0.0727,0.1963,-0.0303,-0.0578],[0.0504,-0.093,-0.0842,0.1223,-0.1509,-0.0418,0.1867,-0.0016,0.1346,0.0533,0.1305,-0.0744,0.0105,-0.0131,0.0981,0.0742,0.2143,0.007,0.0796,0.051,0.1082,0.2377,-0.0407,0.087,-0.3166,-0.0764,0.1478,0.2122,0.0851,-0.1129,-0.0507,0.0666,-0.3296,-0.0534,-0.1387,-0.079,0.056,-0.0091,0.177,0.197,0.0793,0.0487,0.1472,0.0295,0.1019,0.017,0.0605,0.0541,-0.0886,0.0654,0.1485,0.111,-0.0161,-0.0208,0.0227,-0.055,0.1672,0.0607,0.0338,0.0367,0.052,0.0409,-0.0133,0.0046,-0.0066,-0.035,0.1633,-0.0145,-0.0091,0.0615,-0.0558,0.0597,0.1271,0.1883,0.1053,-0.026,-0.0107,0.0109,0.0458,0.0939,0.0028,-0.1076,-0.0124,-0.0907,-0.1441,-0.0253,0.0029,0.0003,0.0224,-0.1183,0.1412,0.0838,-0.0215,0.0964,0.0701,0.0089,-0.1077,0.0575,0.02,0.0994,0.0787,0.0277,0.0287,0.0775,-0.0171,0.072,0.106,-0.0719,0.0614,0.1008,-0.0314,0.0058,0.0453,-0.0372],[0.0429,-0.1619,0.0755,0.0716,-0.1104,0.1278,-0.0781,-0.0209,0.0617,0.1853,0.0177,-0.0502,0.0891,-0.1038,0.0194,0.0289,0.0563,0.0498,-0.0243,0.0103,0.101,0.2463,-0.0198,-0.0022,-0.1839,-0.165,-0.0652,0.3038,0.02,-0.1014,-0.1001,-0.0221,-0.1355,-0.1028,-0.1848,0.0501,0.1004,-0.0016,0.0298,0.1376,0.0537,0.0104,0.0509,0.042,0.074,0.0812,0.0874,0.0634,-0.1452,-0.0059,0.0765,-0.073,-0.0762,-0.0838,0.0897,-0.0718,0.1684,0.1672,-0.0945,0.0688,0.0108,0.0217,-0.0434,-0.0727,-0.0277,-0.0428,0.1922,-0.1039,-0.0479,0.1507,0.0114,0.0776,-0.1019,0.0657,0.0372,-0.0567,-0.0397,-0.0014,0.0912,0.0823,0.1013,-0.0983,0.0266,0.0129,0.0683,0.0602,-0.0087,0.0383,0.0566,0.0105,0.0084,-0.046,0.0343,0.1766,0.0281,0.0577,0.0538,0.0294,-0.0827,-0.0544,0.0631,0.0275,-0.0064,0,0.0101,-0.0317,-0.0309,-0.0285,0.0154,0.0447,-0.0186,-0.0195,-0.0097,-0.0218]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># Let&#39;s now evaluate the portfolio

## Part of the code is adapted from Jonathan Regenstein from RStudio

# We assume an equally weighted portfolio. Allocating 25% to all the stocks in our portfolio
w &lt;- c(.25,.25,.25,.25)

# We use the performanceAnalytics built infuction Return.porftolio to calculate portfolio monthly returns

monthly_P_return &lt;-  Return.portfolio(R = merged_returns, weights = w)

# Use dygraphs to chart the portfolio monthly returns.
dygraph(monthly_P_return, main = &quot;Portfolio Monthly Return&quot;) %&gt;% 
  dyAxis(&quot;y&quot;, label = &quot;Return&quot;)</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"attrs":{"axes":{"x":{"pixelsPerLabel":60},"y":[]},"title":"Portfolio Monthly Return","labels":["month","portfolio.returns"],"legend":"auto","retainDateWindow":false,"ylabel":"Return"},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z"],[0.0301,-0.113708579264149,-0.00559377618293577,0.00786916658390391,-0.0890376855326902,0.0573282327219986,-0.042831236358701,0.0383461039325024,0.0783346839674659,0.110040420027639,0.0582383125115564,-0.0344335250838131,0.0261523950823555,-0.0478623279379287,0.0331144327765902,0.153792419636912,0.112247310719632,0.00149789245166887,0.054078256694402,0.0219968844818357,0.107410539310229,0.157949829530945,-0.0303242130102647,0.0456092318025723,-0.207253112502889,-0.138845865576245,0.0704315483642639,0.159410574555523,0.0444362569993406,-0.0939799707838271,-0.0404127420638229,0.0473124465574433,-0.179029145823455,-0.133223126326917,-0.168983528865221,0.0226911227230571,0.0545710218674125,0.0200600134166751,0.126687155535587,0.136949498384811,0.0319663136685859,0.0629283509111709,0.0658632611747769,0.0108594282541148,0.100731340517966,0.112092560764811,0.0935879851387789,0.0307000599218057,-0.0896041659407795,0.00567424356447033,0.117031202204561,0.0393133206973839,-0.0653368536592297,-0.0745111009596598,0.0605165850969047,-0.0270639430888725,0.182222549972333,0.0747917934575102,0.0161030525226051,0.0439754771241554,0.00196574485688727,0.023824968906363,-0.00307950548584668,0.0245898567238754,-0.00710635623220512,-0.00144247555173027,0.127014948314502,-0.0322341862713332,-0.0131976821622654,0.0434413285162729,-0.0616681017627327,0.00325737773151791,0.0971383327948778,0.0820742787274269,0.0954013200129236,0.0197984608178754,-0.0416550042325423,0.0311362189903313,0.0354200825155371,0.0805186574008934,0.0156770687270402,-0.0947383246215934,0.0168736628752737,-0.045342644860437,-0.0393671996182131,-0.00348182621093573,0.00562309891495172,0.000399990154805074,0.0443709706335647,-0.0361770701926236,0.0783950004828757,0.00559979139341671,0.0355777863984561,0.12989006298412,0.0704084370854767,0.0143011984430976,-0.074298178725309,0.0311996800267746,-0.025672623394713,-0.00432640519518579,0.0541278171096493,0.0305294323072862,0.00339043170589948,0.0674459827309137,-0.0204227034786852,0.0145534744768461,0.0823615119482068,-0.0666482643528976,0.061405211562503,0.0852604189772439,-0.0301942016267269,0.0573998666609123,0.0242677157471534,-0.0213148296410851]]},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># Add the wealth.index = TRUE argument and, instead of returning monthly returns,
# the function will return the growth of $1 invested in the portfolio.
dollar_growth &lt;- Return.portfolio(merged_returns, weights = w, wealth.index = TRUE)

# Use dygraphs to chart the growth of $1 in the portfolio.
dygraph(dollar_growth, main = &quot;Growth of $1 Invested in Portfolio&quot;) %&gt;% 
  dyAxis(&quot;y&quot;, label = &quot;$&quot;)</code></pre>
<div id="htmlwidget-3" style="width:672px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"attrs":{"axes":{"x":{"pixelsPerLabel":60},"y":[]},"title":"Growth of $1 Invested in Portfolio","labels":["month","portfolio.wealthindex"],"legend":"auto","retainDateWindow":false,"ylabel":"$"},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z"],[1.0301,0.9129687925,0.90786184941275,0.91500596554095,0.833535952120579,0.881321095165901,0.843573023030941,0.87592076184674,0.944535737906547,1.0484728472369,1.10953413657416,1.07132896505109,1.09934678340828,1.04672948714328,1.08139134038056,1.24770113119209,1.38775222775025,1.38983093133698,1.46499056520364,1.49721579343341,1.65803254926988,1.91991850778382,1.86169848999143,1.94660912796795,1.54316832737006,1.32890578522652,1.42250267731025,1.64926464640704,1.72255179409471,1.56066642681206,1.49759561705764,1.56845052965434,1.28765217106398,1.11610712321319,0.927503402941018,0.948549496483206,1.00031281179811,1.02037910022366,1.14964802599895,1.3070917464786,1.34887465124015,1.43375710862858,1.52818902753537,1.54478428663862,1.70039247864282,1.89099382587911,2.06796812795301,2.13145487339755,1.94046763722636,1.95147832322895,2.17986217747258,2.26555979833165,2.11753524933182,1.95975536658322,2.07835306899417,2.02210463981633,2.39057770359455,2.56937329744592,2.61074805060487,2.72555694178118,2.73091469132164,2.7959786489283,2.78736841734062,2.85590940735968,2.83561429774408,2.83152399344544,3.19116986712419,3.08830510320384,3.04754663403166,3.17993610852929,2.98383548498952,2.99355496425283,3.28434390261018,3.55390405950974,3.89295119798625,3.97002563974549,3.80465420491859,3.92311675142542,4.06207387047899,4.38914660479321,4.45795555776961,4.03561631698899,4.10371194621582,3.91763879282902,3.76341232443967,3.75030877676587,3.77139713397924,3.77290565570269,3.94031314175509,3.7977641566449,4.09548987953892,4.11842376851819,4.26494816965285,4.81892255603307,5.15821536163931,5.23198402313834,4.84325713909925,4.99436521212654,4.86614675493996,4.84509383233885,5.10734818517478,5.26327262586381,5.28111739225133,5.63730754468904,5.5221784842857,5.60254536791334,6.06397947517311,5.65982576808123,6.00736856677716,6.51955932773131,6.32270643887238,6.68562894539975,6.84787388823765,6.70191262290623]]},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># Calculating the Sharpe Ratio
# Taking the US 10 Year Treasury Rate of 2.40% as the risk free rate.
# Making use of the built in SharpeRatio function in Performance Analytics package.
print(sharpe_ratio &lt;- round(SharpeRatio(monthly_P_return, Rf = 0.024), 4))</code></pre>
<pre><code>##                                 portfolio.returns
## StdDev Sharpe (Rf=2.4%, p=95%):           -0.0634
## VaR Sharpe (Rf=2.4%, p=95%):              -0.0424
## ES Sharpe (Rf=2.4%, p=95%):               -0.0298</code></pre>
